
<div class="payment-container">
  <!-- Contenido principal -->
  <div class="payment-content">
    <!-- Sección del formulario -->
    <div class="form-section">
      <div class="section-header">
        <h2 class="section-title">Información de Pago</h2>
        <p class="section-subtitle">Complete los datos de su tarjeta de forma segura</p>
      </div>

      <form [formGroup]="paymentForm" (ngSubmit)="onSubmit()" class="payment-form">
        <!-- Email -->
        <div class="form-group">
          <label class="form-label">Correo Electrónico</label>
          <div class="input-wrapper">
            <div class="input-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
              </svg>
            </div>
            <input
              type="email"
              formControlName="email"
              placeholder="ejemplo@correo.com"
              class="form-input"
              [class.error]="paymentForm.get('email')?.invalid && paymentForm.get('email')?.touched">
          </div>
          <div class="error-message" *ngIf="paymentForm.get('email')?.invalid && paymentForm.get('email')?.touched">
            Por favor ingrese un correo válido
          </div>
        </div>

        <!-- Información de tarjeta -->
        <div class="card-section">
          <h3 class="subsection-title">Información de la Tarjeta</h3>

          <!-- Número de tarjeta -->
          <div class="form-group">
            <label class="form-label">Número de Tarjeta</label>
            <div class="input-wrapper">
              <div class="input-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4v-6h16v6zm0-10H4V6h16v2z"/>
                </svg>
              </div>
              <input
                type="text"
                placeholder="1234 5678 9012 3456"
                class="form-input"
                maxlength="19"
                (input)="formatCardNumber($event)"
                [class.error]="paymentForm.get('cardNumber')?.invalid && paymentForm.get('cardNumber')?.touched">
              <div class="card-type-icon" [ngClass]="getCardType(paymentForm.get('cardNumber')?.value || '')">
                💳
              </div>
            </div>
          </div>

          <!-- Fecha y CVV -->
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">Fecha de Expiración</label>
              <input
                type="text"
                placeholder="MM/AA"
                class="form-input"
                maxlength="5"
                (input)="formatExpiryDate($event)"
                [class.error]="paymentForm.get('expiryDate')?.invalid && paymentForm.get('expiryDate')?.touched">
            </div>
            <div class="form-group">
              <label class="form-label">CVV</label>
              <input
                type="text"
                formControlName="cvv"
                placeholder="123"
                class="form-input"
                maxlength="4"
                [class.error]="paymentForm.get('cvv')?.invalid && paymentForm.get('cvv')?.touched">
            </div>
          </div>

          <!-- País -->
          <div class="form-group">
            <label class="form-label">País o Región</label>
            <input
              type="text"
              formControlName="country"
              placeholder="México"
              class="form-input"
              [class.error]="paymentForm.get('country')?.invalid && paymentForm.get('country')?.touched">
          </div>
        </div>
      </form>
    </div>

    <!-- Sección de resumen -->
    <div class="summary-section">
      <div class="summary-card">
        <h3 class="summary-title">Resumen de Compra</h3>

        <div class="summary-details">
          <div class="detail-row">
            <span class="detail-label">Servicio:</span>
            <span class="detail-value">{{ summaryData.serviceName }}</span>
          </div>

          <div class="detail-row">
            <span class="detail-label">Cliente:</span>
            <span class="detail-value">{{ summaryData.customerName }}</span>
          </div>

          <div class="detail-row">
            <span class="detail-label">Banco:</span>
            <span class="detail-value">{{ summaryData.bank }}</span>
          </div>

          <div class="detail-row">
            <span class="detail-label">Cuenta:</span>
            <span class="detail-value">{{ summaryData.accountNumber }}</span>
          </div>

          <div class="pricing-breakdown">
            <div class="price-row">
              <span>Subtotal:</span>
              <span>${{ summaryData.subtotal }} MXN</span>
            </div>
            <div class="price-row">
              <span>Impuestos:</span>
              <span>${{ summaryData.taxes }} MXN</span>
            </div>
          </div>

          <div class="total-row">
            <span class="total-label">Total a Pagar:</span>
            <span class="total-amount">${{ summaryData.totalAmount }} MXN</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Botones de acción -->
  <div class="action-buttons">
    <button type="button" class="btn btn-secondary" (click)="onGoBack()" [disabled]="isProcessing">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
        <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
      </svg>
      Volver
    </button>

    <button type="submit" class="btn btn-primary" (click)="onSubmit()" [disabled]="isProcessing">
      <span *ngIf="!isProcessing">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
          <path d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"/>
        </svg>
        Procesar Pago
      </span>
      <span *ngIf="isProcessing" class="processing">
        <div class="spinner"></div>
        Procesando...
      </span>
    </button>
  </div>

  <!-- Indicador de paso -->
  <!-- <div class="step-indicator">
  </div> -->
</div>
